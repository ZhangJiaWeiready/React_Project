const {ChatModel} = require('../db/models')module.exports = function (server) {    //socket.io是一个函数 函数传入参数 得到io对象    // 将它挂在服务器上server 从www里面传过去的    const io = require('socket.io')(server)    // 监听连接 当有一个客户连接上时回调 ，    // 有客户端和我连接的时候就会出发回调，socket当前服务器与浏览器连接对象    // io 表示任意浏览器    // socket 表示一个连接 绑定监视    io.on('connection',function (socket) {        console.log('有一个客户连接上了服务器')        //绑定sendMsg监听，接收客户端发送的消息 回调函数 浏览器发来的信息        socket.on('sendMsg',function ({from,to,content}) {            console.log('服务器接收到浏览器的信息',{from,to,content})            // 收到数据 处理数据(保存数据)                // 保存数据 需要 chat_id  和 time            const chat_id = [from,to].sort().join('_') // 使得他们不管顺序怎么样结果都一致            const create_time = Date.now()            new ChatModel({from,to,content,chat_id,create_time}).save(function (err, chatMsg) {                //向所有连接的客户端发送信息  不止向我发还需要向to的人发，但是有可能人不在线--解决 用io使得向所有人发送                io.emit('receiveMsg',chatMsg)            })        })    })}